---
title: "リレーショナル・データベースの正規化 (normalize rdb)"
subtitle: "そして整然化 (and make it tidy)"
emoji: "😎"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [relational, rdb, normalize, tidy, table, Codd, Boyce, 1NF, 2NF, 3NF, 4NF, 5NF, BCNF, pivot, melt]
published: false
---
## データフレーム (dataframe)

データフレームとは以下のようなもの．

| name | age | gender | height | weight | origin | job |
|:--|--:|--:|--:|--:|:---|:---|
| 中村 | 22 | 男 | 172 | 62 | 長崎 | 大学生 |
| 田中 | 50 | 女 | 160 | 40 | 東京 | OL |

- `name` や `age` ... を *variable* 「変数」「属性」「ラベル」「フィールド」と呼ぶ．
- `中村` や `女` ... を *value* 「値」と呼ぶ．
- 各行 (each rows) は instance や 「レコード」
    - instance の個数を $N$ や sample size （標本サイズ，標本の大きさ，群サイズ，群の大きさ）という．
    - ちなみに，「標本数 (number of sample)」は同じサイズの標本テーブルの個数，「セット」ともいう．
- 各列 (each columns) は series
    - columns の個数を dimension （次元）という

## 実体 (Entity) と 関係 (Relationship)

実体 (Entity) とは，データベースで表現したい対象物．1つの Entity は，複数の属性を持つ．ただしデータベースにはその属性の数個があるのみ．

関係 (Relationship) とは，Entity と 別の Entity との関係．大きく分けると 「従属」または「独立」

### ER図 (ER diagram; ERD)

Entity は □ ，Relationship は ◇ で表す．

常に $E_i$ -- $R_{ij}$ -- $E_j$ のようになる．

Entity には，valiable (属性) が結ばれる．valiable は ○ で表す．

## 従属

属性それぞれが，矢先となる．つまり矢（関係）の数は属性の数に等しい．

矢元は，属性の集合となる（独立関係の場合は空集合）．

- 独立 （X ← ∅）
- 従属 （X ← {A,B,...）
    - 多値 : X ← A (矢元Aの水準数 < 矢先Xの水準数)
    - 関数 : X <-(f)- {A,B,...} （矢元 属性集合{A,B,...}の水準数 $\geq$ 矢先 Xの水準数）．$$X \leftarrow f(\{A,B,\dots\})$$
        - 部分-関数従属
            - 元が同じ属性となる矢が複数ある状態．
            - 特に $R_i$ の矢元が別の $R_j$ の矢元の *属性集合のうちの1つ* であるとき，その $R_i$ を「部分関数従属」という
        - 推移的-関数従属
            - $R_i$ の矢元が $R_j$ の矢先になっているとき，$R_i$ を「推移的関数従属」という
            - 所謂「マルチコ」（多重共線性， Multicollinearity）
        - 完全-関数従属
            - いかなる包含関係，関係の重複がない状態
        - 多値-関数従属
            - $R_i$ の矢元 $E_a$ が別の $R_j$ の矢元 $E_a$ と同一であるとき，その $R_i$ を「多値関数従属」という．

完全関数従属の状態の関係 $R$ において，矢元を独立属性（独立変数），矢先を従属属性（従属変数）という．

各表は，1つの関数従属を表すことになる．矢元が「主キー」．集合である場合は「複合主キー」である．いずれの場合も1つの表は1つの関数従属関係であり矢元が1つ，すなわち主キーは1つ．


### 第2正規化 部分関数従属の解消

R_A : A <- ∅
R_B : B <- ∅
R_C : C <- {A,B}
R_D : D <- A

のとき，R_D の矢元 A が，R_C の矢元 {A,B} に含まれる．よって，R_D は部分関数従属．

部分関数従属関係を別テーブルに分離すればよい．

表1
|A|B|C|
|---|---|---|

表2
|A|D|
|---|---|

### 第3正規化 推移的関数従属の解消



